# LotoBot Backend

Backend API –¥–ª—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –ø–æ –ø–æ–¥–±–æ—Ä—É –ª–æ—Ç–µ—Ä–µ–π —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö –°—Ç–æ–õ–æ—Ç–æ.

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–ø–∏—Å–∞–Ω–∏–µ](#–æ–ø–∏—Å–∞–Ω–∏–µ)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#–∑–∞–ø—É—Å–∫-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- [API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞](#—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- [Docker](#docker)
- [WebSocket API](#websocket-api)

---

## –û–ø–∏—Å–∞–Ω–∏–µ

LotoBot Backend - —ç—Ç–æ REST API –∏ WebSocket —Å–µ—Ä–≤–µ—Ä –Ω–∞ FastAPI, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

- **AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –ª–æ—Ç–µ—Ä–µ–π** - –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º RAG (Retrieval-Augmented Generation) –∏ Grok AI
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API –°—Ç–æ–õ–æ—Ç–æ** - –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ª–æ—Ç–µ—Ä–µ—è—Ö, —Ä–æ–∑—ã–≥—Ä—ã—à–∞—Ö, –Ω–æ–≤–æ—Å—Ç—è—Ö
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **WebSocket —á–∞—Ç** - real-time –æ–±—â–µ–Ω–∏–µ —Å AI –±–æ—Ç–æ–º

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.13** - —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **FastAPI** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è API
- **Uvicorn** - ASGI —Å–µ—Ä–≤–µ—Ä –¥–ª—è FastAPI
- **Redis** - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **OpenRouter/Grok** - AI –º–æ–¥–µ–ª—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- **Sentence Transformers** - —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è RAG —Å–∏—Å—Ç–µ–º—ã
- **scikit-learn** - –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞
- **httpx** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **UV** - –±—ã—Å—Ç—Ä—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ Python

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.13+
- Redis 7.0+
- UV (–º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ Python)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ UV

```bash
# Windows (PowerShell)
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"

# Linux/Mac
curl -LsSf https://astral.sh/uv/install.sh | sh
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
uv sync
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# ----- APP CONFIG -----
APP_NAME=LotoBot
APP_HOST=0.0.0.0
APP_PORT=8000
DEBUG=False

# ----- REDIS -----
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASS=your_redis_password
REDIS_DB=0

# ----- OPENAI / AI -----
OPENAI_API_KEY=your_openai_api_key
OPENAI_BASE_URL=https://openrouter.ai/api/v1

# ----- LOGGER -----
LOG_LEVEL=INFO
LOG_TO_FILE=False
SENSITIVE_DATA=
```

**–í–∞–∂–Ω–æ:** –ó–∞–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

---

## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

1. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Redis –∑–∞–ø—É—â–µ–Ω:**
   ```bash
   redis-server
   ```

2. **–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
   ```bash
   # Windows
   .venv\Scripts\activate

   # Linux/Mac
   source .venv/bin/activate
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   uv run uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload
   ```

   –ò–ª–∏ —á–µ—Ä–µ–∑ Python:
   ```bash
   python src/main.py
   ```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

**–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:**
```bash
docker compose -f docker-compose.local.yml up --build
```

**Production:**
```bash
docker compose -f docker-compose.prod.yml up --build
```

**–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ:**
```bash
docker compose up --build
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000`

---

## API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### Swagger UI

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
- **Swagger UI:** `http://localhost:8000/docs`
- **ReDoc:** `http://localhost:8000/redoc`

### –û—Å–Ω–æ–≤–Ω—ã–µ endpoints

#### Health Check

```http
GET /health
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞.

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "ok"
}
```

---

### API –°—Ç–æ–õ–æ—Ç–æ (`/api/stoloto`)

### API AI (`/api/ai`)

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-----------|-----|--------------|----------|--------------|
| `APP_NAME` | string | –ù–µ—Ç | –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | `LotoBot` |
| `APP_HOST` | string | –î–∞ | –•–æ—Å—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | - |
| `APP_PORT` | integer | –î–∞ | –ü–æ—Ä—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | - |
| `DEBUG` | boolean | –ù–µ—Ç | –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ | `False` |

#### Redis

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|-----|--------------|----------|
| `REDIS_HOST` | string | –î–∞ | –•–æ—Å—Ç Redis |
| `REDIS_PORT` | integer | –î–∞ | –ü–æ—Ä—Ç Redis |
| `REDIS_PASS` | string | –ù–µ—Ç | –ü–∞—Ä–æ–ª—å Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `REDIS_DB` | integer | –î–∞ | –ù–æ–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Redis |

#### AI/OpenRouter

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-----------|-----|--------------|----------|--------------|
| `OPENAI_API_KEY` | string | –ù–µ—Ç | API –∫–ª—é—á OpenRouter | - |
| `OPENAI_BASE_URL` | string | –ù–µ—Ç | –ë–∞–∑–æ–≤—ã–π URL API | `https://openrouter.ai/api/v1` |

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-----------|-----|--------------|----------|--------------|
| `LOG_LEVEL` | string | –ù–µ—Ç | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | `INFO` |
| `LOG_TO_FILE` | boolean | –ù–µ—Ç | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –≤ —Ñ–∞–π–ª | `False` |
| `SENSITIVE_DATA` | string | –ù–µ—Ç | –°–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ –≤ –ª–æ–≥–∞—Ö | - |

---

## Docker

### Dockerfile

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç multi-stage build –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–±—Ä–∞–∑–∞:

1. **base** - –±–∞–∑–æ–≤–∞—è —Å—Ç–∞–¥–∏—è —Å Python –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ —Å–∏—Å—Ç–µ–º—ã
2. **builder** - —Å—Ç–∞–¥–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ UV
3. **final** - —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞–¥–∏—è —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Python 3.13-slim –æ–±—Ä–∞–∑
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç UV –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Docker Compose

#### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (`docker-compose.local.yml`)

–í–∫–ª—é—á–∞–µ—Ç:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—Å–±–æ—Ä–∫–∞ –∏–∑ Dockerfile)
- Redis

**–ó–∞–ø—É—Å–∫:**
```bash
docker compose -f docker-compose.local.yml up --build
```

#### Production (`docker-compose.prod.yml`)

–í–∫–ª—é—á–∞–µ—Ç:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∏–∑ Docker Registry)
- Redis
- Volume –¥–ª—è –ª–æ–≥–æ–≤

**–ó–∞–ø—É—Å–∫:**
```bash
docker compose -f docker-compose.prod.yml up --build
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Docker

–í Docker Compose –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ `.env`:

```yaml
env_file:
  - .env
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

---

## WebSocket API

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ WebSocket API –¥–ª—è —á–∞—Ç–∞ —Å AI –±–æ—Ç–æ–º.

### Endpoint

```
ws://localhost:8000/api/ai/chat
```

### –ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å –ø–æ–ª—è–º–∏:
- `code` - –∫–æ–¥ —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- `data` - –¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—ä–µ–∫—Ç–æ–º, –º–∞—Å—Å–∏–≤–æ–º –∏–ª–∏ `null`)

### –û—Å–Ω–æ–≤–Ω–æ–π flow

1. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** - –∫–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WebSocket
2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** - —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —á–∞—Ç–∞
3. **–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** - –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π)
4. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π** - –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. **–ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤** - —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç

### –ö–æ–¥—ã —Å–æ–æ–±—â–µ–Ω–∏–π

#### –û—Ç —Å–µ—Ä–≤–µ—Ä–∞ –∫ –∫–ª–∏–µ–Ω—Ç—É:

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `CONNECTION_ESTABLISHED` | –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ |
| `REQUEST_CHAT_CONTEXT` | –ó–∞–ø—Ä–æ—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —á–∞—Ç–∞ |
| `CHAT_CONTEXT_RECEIVED` | –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—É—á–µ–Ω –∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω |
| `STATUS_RAG_PROCESSING` | –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ RAG —Å–∏—Å—Ç–µ–º—É |
| `STATUS_GROK_PROCESSING` | –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ Grok AI |
| `STATUS_STOLOTO_FETCHING` | –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –°—Ç–æ–õ–æ—Ç–æ |
| `RESPONSE_MESSAGE` | –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ |
| `ERROR` | –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ |

#### –û—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É:

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `CHAT_CONTEXT` | –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —á–∞—Ç–∞ |
| `SEND_MESSAGE` | –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

### –ü—Ä–∏–º–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π

#### –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç:

```json
{
  "code": "CHAT_CONTEXT",
  "data": [
    {
      "role": "user",
      "content": "–ü—Ä–∏–≤–µ—Ç!"
    },
    {
      "role": "assistant",
      "content": "–ü—Ä–∏–≤–µ—Ç! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?"
    }
  ]
}
```

#### –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ:

```json
{
  "code": "SEND_MESSAGE",
  "data": {
    "message": "–ü–æ–¥–±–µ—Ä–∏ –º–Ω–µ –±—ã—Å—Ç—Ä—É—é –ª–æ—Ç–µ—Ä–µ—é —Å –Ω–µ–±–æ–ª—å—à–∏–º –ø—Ä–∏–∑–æ–º"
  }
}
```

#### –°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç:

```json
{
  "code": "RESPONSE_MESSAGE",
  "data": {
    "action": "search",
    "content": [...],
    "formatted_text": "–í–æ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ª–æ—Ç–µ—Ä–µ–∏:\n\n1. –ë—ã—Å—Ç—Ä–∞—è –ª–æ—Ç–µ—Ä–µ—è..."
  }
}
```

### –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ WebSocket API —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞ –Ω–∞ JavaScript/TypeScript –∏ React, —Å–º. —Ä–∞–∑–¥–µ–ª WebSocket –≤ Swagger UI (`/docs`) –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º backend.

---

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç API –°—Ç–æ–õ–æ—Ç–æ –∫–µ—à–∏—Ä—É—é—Ç—Å—è –≤ Redis —Å TTL (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–µ—à–∞). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –£–º–µ–Ω—å—à–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –≤–Ω–µ—à–Ω–∏–π API
- –£—Å–∫–æ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã
- –°–Ω–∏–∑–∏—Ç—å —Ä–∞—Å—Ö–æ–¥ —Ç—Ä–∞—Ñ–∏–∫–∞

### Rate Limiting

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API –°—Ç–æ–õ–æ—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã **1 –∑–∞–ø—Ä–æ—Å –≤ —Å–µ–∫—É–Ω–¥—É**. –≠—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –±–∞–∑–æ–≤–æ–º –∫–ª–∏–µ–Ω—Ç–µ.

### RAG —Å–∏—Å—Ç–µ–º–∞

RAG (Retrieval-Augmented Generation) —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
- –ü–æ–∏—Å–∫–∞ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ª–æ—Ç–µ—Ä–µ–π –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö AI –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤

### AI –∞–≥–µ–Ω—Ç

AI –∞–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- **Grok AI** (—á–µ—Ä–µ–∑ OpenRouter) - –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
- **RAG** - –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ª–æ—Ç–µ—Ä–µ—è—Ö
- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–π** - –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (async/await)
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Redis
- Rate limiting –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API
- Multi-stage Docker build –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –æ–±—Ä–∞–∑–∞
- UV –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ middleware. –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `LOG_LEVEL`.
